"use strict";(()=>{var e={};e.id=7936,e.ids=[7936],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},3294:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>O,patchFetch:()=>C,requestAsyncStorage:()=>v,routeModule:()=>j,serverHooks:()=>x,staticGenerationAsyncStorage:()=>T});var a={};t.r(a),t.d(a,{DELETE:()=>w,GET:()=>E,POST:()=>f,PUT:()=>h,sort:()=>S});var s=t(9303),n=t(8716),o=t(3131),i=t(7147),l=t.n(i),c=t(1017),p=t.n(c);let u=p().join(process.cwd(),"storage"),d=p().join(u,"gallery.json"),g=p().join(process.cwd(),"public/assets/images/gallery");l().existsSync(u)||(l().mkdirSync(u,{recursive:!0}),console.log("Created storage directory:",u)),l().existsSync(d)||(l().writeFileSync(d,"[]","utf-8"),console.log("Created gallery.json file with an empty array."));let y=()=>{try{let e=l().readFileSync(d,"utf-8");return JSON.parse(e)}catch(e){throw console.error("Error reading gallery data:",e),Error("Failed to read gallery data.")}},m=e=>{try{l().writeFileSync(d,JSON.stringify(e,null,2)),console.log("Gallery data saved successfully.")}catch(e){throw console.error("Error writing gallery data:",e),Error("Failed to write gallery data.")}};async function f(e){try{let r=await e.formData(),{id:t}=Object.fromEntries(r.entries()),a=r.get("image"),s="";if(a&&a.size>0)try{l().existsSync(g)||(l().mkdirSync(g,{recursive:!0}),console.log("Created image storage directory:",g));let e=p().join(g,a.name),r=await a.arrayBuffer();await l().promises.writeFile(e,Buffer.from(r)),s=`/assets/images/gallery/${a.name}`,console.log("Image uploaded successfully. Updated imageUrl:",s)}catch(e){throw console.error("Error uploading image:",e),Error("Failed to upload image.")}let n={id:t,imageUrl:s},o=y();return o.push(n),m(o),new Response(JSON.stringify({message:"Data saved successfully!"}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error in POST method:",e),new Response(JSON.stringify({message:`Error saving server data: ${e.message}`}),{status:500,headers:{"Content-Type":"application/json"}})}}async function h(e){try{let r=parseInt(new URL(e.url).searchParams.get("index")),t=await e.formData(),a=y(),s=a[r],n=t.get("id")||s.id,o=s.imageUrl,i=t.get("image");if(i&&i.size>0)try{l().existsSync(g)||(l().mkdirSync(g,{recursive:!0}),console.log("Created image storage directory:",g));let e=p().join(g,i.name),r=await i.arrayBuffer();await l().promises.writeFile(e,Buffer.from(r)),o=`/assets/images/gallery/${i.name}`,console.log("Image uploaded successfully:",o)}catch(e){throw console.error("Error uploading image:",e),Error("Failed to upload image.")}let c={id:n,imageUrl:o};return a[r]=c,m(a),new Response(JSON.stringify({message:"Data updated successfully!"}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error in PUT method:",e),new Response(JSON.stringify({message:`Error updating server data: ${e.message}`}),{status:500,headers:{"Content-Type":"application/json"}})}}async function w(e){try{let r=parseInt(new URL(e.url).searchParams.get("index")),t=y();return t.splice(r,1),m(t),new Response(JSON.stringify({message:"Data deleted successfully!"}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error in DELETE method:",e),new Response(JSON.stringify({message:`Error deleting server data: ${e.message}`}),{status:500,headers:{"Content-Type":"application/json"}})}}async function E(){try{let e=y();return new Response(JSON.stringify(e),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error in GET method:",e),new Response(JSON.stringify({message:"Error fetching server data."}),{status:500,headers:{"Content-Type":"application/json"}})}}async function S(e){try{let r=await e.json();if(!Array.isArray(r))return new Response(JSON.stringify({message:"Invalid data format"}),{status:400,headers:{"Content-Type":"application/json"}});return m(r),new Response(JSON.stringify({message:"Gallery order updated successfully!"}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error updating gallery order:",e),new Response(JSON.stringify({message:`Error updating gallery order: ${e.message}`}),{status:500,headers:{"Content-Type":"application/json"}})}}let j=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/gallery/route",pathname:"/api/gallery",filename:"route",bundlePath:"app/api/gallery/route"},resolvedPagePath:"/home/ziad/ASG_Distribution/app/api/gallery/route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:v,staticGenerationAsyncStorage:T,serverHooks:x}=j,O="/api/gallery/route";function C(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:T})}},9303:(e,r,t)=>{e.exports=t(517)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[8948],()=>t(3294));module.exports=a})();