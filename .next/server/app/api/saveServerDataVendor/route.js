"use strict";(()=>{var e={};e.id=4524,e.ids=[4524],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2597:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>j,patchFetch:()=>O,requestAsyncStorage:()=>h,routeModule:()=>v,serverHooks:()=>x,staticGenerationAsyncStorage:()=>w});var s={};r.r(s),r.d(s,{DELETE:()=>m,GET:()=>S,POST:()=>y,PUT:()=>f});var a=r(9303),n=r(8716),o=r(3131),i=r(7147),c=r.n(i),l=r(1017),p=r.n(l);let u=p().join(process.cwd(),"storage"),d=p().join(u,"serverDataVendor.json"),g=p().join("C:\\Users\\ASG\\Downloads\\lockdown-security-cctv-react-next-js-template-2024-07-25-10-26-46-utc\\lockdown pack\\lockdown\\public\\assets\\images\\blog");async function y(e){try{let t=await e.formData();console.log("Form data received:",t);let{id:r,date:s,title:a,category:n,comments:o,description:i}=Object.fromEntries(t.entries()),l=t.get("image"),y="";if(l&&l.size>0)try{c().existsSync(g)||(c().mkdirSync(g,{recursive:!0}),console.log("Created image storage directory:",g));let e=p().join(g,l.name),t=await l.arrayBuffer();await c().promises.writeFile(e,Buffer.from(t)),y=l.name,console.log("Image uploaded successfully:",y)}catch(e){throw console.error("Error uploading image:",e),Error("Failed to upload image.")}let f={id:r,date:s,title:a,description:i,category:n,comments:o,imageUrl:y};console.log("Constructed blog object:",f),c().existsSync(u)||(c().mkdirSync(u),console.log("Created storage directory:",u));let m=[];if(c().existsSync(d)){let e=c().readFileSync(d,"utf-8");m=JSON.parse(e),console.log("Read existing blogs:",m)}return m.push(f),c().writeFileSync(d,JSON.stringify(m,null,2)),console.log("Blog data saved successfully."),new Response(JSON.stringify({message:"Data saved successfully!"}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error in POST method:",e),new Response(JSON.stringify({message:`Error saving server data: ${e.message}`}),{status:500,headers:{"Content-Type":"application/json"}})}}async function f(e){try{let t=parseInt(new URL(e.url).searchParams.get("index")),r=await e.formData(),s=[];if(c().existsSync(d)){let e=c().readFileSync(d,"utf-8");s=JSON.parse(e)}let a=s[t],n=r.get("id")||a.id,o=r.get("date")||a.date,i=r.get("title")||a.title,l=r.get("description")||a.description,u=r.get("category")||a.category,y=r.get("comments")||a.comments,f=a.imageUrl,m=r.get("image");if(m&&m.size>0){c().existsSync(g)||c().mkdirSync(g,{recursive:!0});let e=p().join(g,m.name),t=await m.arrayBuffer();await c().promises.writeFile(e,Buffer.from(t)),f=m.name}let S={id:n,date:o,title:i,description:l,category:u,comments:y,imageUrl:f};return s[t]=S,c().writeFileSync(d,JSON.stringify(s,null,2)),new Response(JSON.stringify({message:"Data updated successfully!"}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error updating server data:",e),new Response(JSON.stringify({message:"Error updating server data."}),{status:500,headers:{"Content-Type":"application/json"}})}}async function m(e){try{let t=parseInt(new URL(e.url).searchParams.get("index")),r=[];if(c().existsSync(d)){let e=c().readFileSync(d,"utf-8");r=JSON.parse(e)}return r.splice(t,1),c().writeFileSync(d,JSON.stringify(r,null,2)),new Response(JSON.stringify({message:"Data deleted successfully!"}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error deleting server data:",e),new Response(JSON.stringify({message:"Error deleting server data."}),{status:500,headers:{"Content-Type":"application/json"}})}}async function S(){try{if(!c().existsSync(d))return new Response(JSON.stringify([]),{status:200,headers:{"Content-Type":"application/json"}});{let e=c().readFileSync(d,"utf-8"),t=JSON.parse(e);return new Response(JSON.stringify(t),{status:200,headers:{"Content-Type":"application/json"}})}}catch(e){return console.error("Error fetching server data:",e),new Response(JSON.stringify({message:"Error fetching server data."}),{status:500,headers:{"Content-Type":"application/json"}})}}let v=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/saveServerDataVendor/route",pathname:"/api/saveServerDataVendor",filename:"route",bundlePath:"app/api/saveServerDataVendor/route"},resolvedPagePath:"/home/ziad/ASG_Distribution/app/api/saveServerDataVendor/route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:w,serverHooks:x}=v,j="/api/saveServerDataVendor/route";function O(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:w})}},9303:(e,t,r)=>{e.exports=r(517)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948],()=>r(2597));module.exports=s})();